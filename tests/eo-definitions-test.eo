
(declare-const Int Type)
(declare-consts <numeral> Int)

(declare-const or (-> Bool Bool Bool) :right-assoc-nil false)
(declare-const and (-> Bool Bool Bool) :right-assoc-nil true)
(declare-const a Bool)
(declare-const b Bool)
(declare-const c Bool)
(declare-const d Bool)

; The builtin Eunoia list.
(declare-const eo_List Type)
(declare-const eo_List_nil eo_List)
(declare-parameterized-const eo_List_cons
  ((T Type :implicit)) (-> T eo_List eo_List)
  :right-assoc-nil eo_List_nil)

; Note that $eo_nil is dynamically modified based on the declared constants,
; as described below. This means we cannot provide a static definition of it
; in this signature, and this is not equivalent to the builtin $eo_nil.
(program $eo_nil ((T Type) (U Type) (V Type) (W Type) (Any Type))
  :signature ((-> T U V) W) Any
  (
  (($eo_nil or Bool) false)
  (($eo_nil and Bool) true)
  (($eo_nil eo_List_cons eo_List) eo_List_nil)
  )
)

(include "eo-definitions.eo")

(declare-const test01 (eo::requires ($eo_nil or Bool) false Bool))
(declare-const test02 (eo::requires (eo::is_ok ($eo_nil a Bool)) false Bool)) ; since a is not an associative operator

(declare-const test03 (eo::requires ($eo_cons or a (or a b)) (or a a b) Bool))
(declare-const test04 (eo::requires ($eo_cons or false (or a b)) (or false a b) Bool))
(declare-const test05 (eo::requires ($eo_cons or (or a b) (or b)) (or (or a b) b) Bool))
(declare-const test06 (eo::requires ($eo_cons or false false) (or false) Bool))
(declare-const test07 (eo::requires ($eo_cons or a (or b)) (or a b) Bool))
(declare-const test08 (eo::requires ($eo_cons and (or a b) (and b)) (and (or a b) b) Bool))
(declare-const test010 (eo::requires ($eo_cons and (and a) true) (and (and a)) Bool))
(declare-const test011 (eo::requires (eo::is_ok ($eo_cons or a b)) false Bool)) ; since b is not an or-list

(declare-const test012 (eo::requires ($eo_list_len or (or a b)) 2 Bool))
(declare-const test013 (eo::requires ($eo_list_len or (or (or a a) b)) 2 Bool))
(declare-const test014 (eo::requires ($eo_list_len or false) 0 Bool))
(declare-const test015 (eo::requires (eo::is_ok ($eo_list_len or (and a b))) false Bool)) ; since (and a b) is not an or-list

(declare-const test016 (eo::requires ($eo_list_concat or false false) false Bool))
(declare-const test017 (eo::requires ($eo_list_concat or (or a b) (or b)) (or a b b) Bool))
(declare-const test018 (eo::requires ($eo_list_concat or (or (or a a)) (or b)) (or (or a a) b) Bool))
(declare-const test019 (eo::requires ($eo_list_concat or false (or b)) (or b) Bool))
(declare-const test020 (eo::requires ($eo_list_concat or (or a b b) false) (or a b b) Bool))
(declare-const test021 (eo::requires ($eo_list_concat or (or a) (or b)) (or a b) Bool))
(declare-const test022 (eo::requires (eo::is_ok ($eo_list_concat or a (or b))) false Bool)) ; since a is not an or-list
(declare-const test023 (eo::requires (eo::is_ok ($eo_list_concat or (or a) b)) false Bool)) ; since b is not an or-list
(declare-const test024 (eo::requires (eo::is_ok ($eo_list_concat or (and a b) false)) false Bool)) ; since (and a b) is not an or-list

(declare-const test025 (eo::requires ($eo_list_nth or (or a b a) 1) b Bool))
(declare-const test026 (eo::requires ($eo_list_nth or (or a) 0) a Bool))
(declare-const test027 (eo::requires (eo::is_ok ($eo_list_nth or false 0)) false Bool)) ; since false has <=0 children
(declare-const test028 (eo::requires (eo::is_ok ($eo_list_nth or (or a b a) 3)) false Bool))  ; since (or a b a) has <=3 children
(declare-const test029 (eo::requires (eo::is_ok ($eo_list_nth or (and a b b) 0)) false Bool))  ; since (and a b b) is not an or-list

(declare-const test030 (eo::requires ($eo_list_find or (or a b a) b) 1 Bool))
(declare-const test031 (eo::requires ($eo_list_find or (or a b a) true) -1 Bool))
(declare-const test032 (eo::requires (eo::is_ok ($eo_list_find or (and a b b) a)) false Bool)) ; since (and a b b) is not an or-list

(declare-const test1 (eo::requires ($eo_list_rev or (or a b c)) (or c b a) Bool))
(declare-const test2 (eo::requires ($eo_list_rev or false) false Bool))

(declare-const test3 (eo::requires ($eo_list_erase or (or a b c) a) (or b c) Bool))
(declare-const test4 (eo::requires ($eo_list_erase or (or c a a b a) a) (or c a b a) Bool))
(declare-const test5 (eo::requires ($eo_list_erase or (or a b c) d) (or a b c) Bool))
(declare-const test6 (eo::requires ($eo_list_erase or false d) false Bool))

(declare-const test7 (eo::requires ($eo_list_erase_all or (or a b c) a) (or b c) Bool))
(declare-const test8 (eo::requires ($eo_list_erase_all or (or a a b a) a) (or b) Bool))
(declare-const test9 (eo::requires ($eo_list_erase_all or (or a b c) d) (or a b c) Bool))
(declare-const test10 (eo::requires ($eo_list_erase_all or false d) false Bool))

(declare-const test7 (eo::requires ($eo_list_setof or (or a b c)) (or a b c) Bool))
(declare-const test8 (eo::requires ($eo_list_setof or (or a b a c a b c)) (or a b c) Bool))
(declare-const test9 (eo::requires ($eo_list_setof or (or a a a)) (or a) Bool))
(declare-const test10 (eo::requires ($eo_list_setof or false) false Bool))

(declare-const test11 (eo::requires ($eo_list_minclude or (or a b) (or a a b)) true Bool))
(declare-const test12 (eo::requires ($eo_list_minclude or (or a b) (or b a)) true Bool))
(declare-const test13 (eo::requires ($eo_list_minclude or (or a b b) (or a b)) false Bool))
(declare-const test14 (eo::requires ($eo_list_minclude or false (or a b)) true Bool))

(declare-const test15 (eo::requires ($eo_list_meq or (or a b) (or a a b)) false Bool))
(declare-const test16 (eo::requires ($eo_list_meq or (or a b c b) (or b a c b)) true Bool))
(declare-const test17 (eo::requires ($eo_list_meq or (or a b b) (or a a b)) false Bool))
(declare-const test18 (eo::requires ($eo_list_meq or false false) true Bool))

(declare-const test19 (eo::requires ($eo_list_diff or (or a b) (or a a b)) false Bool))
(declare-const test20 (eo::requires ($eo_list_diff or (or a a b) (or a b)) (or a) Bool))
(declare-const test21 (eo::requires ($eo_list_diff or (or a b c b a) (or c b)) (or a b a) Bool))
(declare-const test22 (eo::requires ($eo_list_diff or (or a b a c a) (or a a)) (or b c a) Bool))

(declare-const test23 (eo::requires ($eo_list_inter or (or a b) (or a a b)) (or a b) Bool))
(declare-const test24 (eo::requires ($eo_list_inter or (or a a b) (or a b)) (or a b) Bool))
(declare-const test25 (eo::requires ($eo_list_inter or (or a b c b a) (or c b)) (or b c) Bool))
(declare-const test26 (eo::requires ($eo_list_inter or (or a b a c a) (or a a)) (or a a) Bool))

(declare-const test27 (eo::requires ($eo_list_singleton_elim or (or a b c)) (or a b c) Bool))
(declare-const test28 (eo::requires ($eo_list_singleton_elim or (or a a a)) (or a a a) Bool))
(declare-const test29 (eo::requires ($eo_list_singleton_elim or (or a)) a Bool))
